# AI Notes App - ç³»ç»Ÿæ¶æ„æ–‡æ¡£

> æœ€åæ›´æ–°ï¼š2025-01-07
> ç‰ˆæœ¬ï¼š0.1.0

æœ¬æ–‡æ¡£ä½œä¸ºé¡¹ç›®çš„é•¿æœŸè®°å¿†ï¼Œè®°å½•ç³»ç»Ÿæ¶æ„ã€æ•°æ®ç»“æ„ã€æ ¸å¿ƒé€»è¾‘å’ŒæŠ€æœ¯æ ˆï¼Œä¾¿äºåç»­å¼€å‘å’Œæœªæ¥è¿ç§»åˆ° React Nativeã€‚

---

## ğŸ“¦ æŠ€æœ¯æ ˆ

### å‰ç«¯
| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| **Next.js** | 16.0.10 | React å…¨æ ˆæ¡†æ¶ |
| **React** | 19.2.1 | UI åº“ |
| **TypeScript** | ^5 | ç±»å‹å®‰å…¨ |
| **Tailwind CSS** | ^4 | æ ·å¼æ¡†æ¶ |
| **Zustand** | ^5.0.9 | çŠ¶æ€ç®¡ç† |
| **Framer Motion** | ^12 | åŠ¨ç”»åº“ |
| **React Markdown** | ^9.0.1 | Markdown æ¸²æŸ“ |
| **Lucide React** | ^0.562.0 | å›¾æ ‡åº“ |

### åç«¯ / æ•°æ®
| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| **Prisma** | ^6.19.1 | ORM |
| **PostgreSQL** | - | æ•°æ®åº“ (Supabase) |
| **Supabase** | ^2.89.0 | BaaS (è®¤è¯ + æ•°æ®åº“æ‰˜ç®¡) |

### AI
| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| **Vercel AI SDK** | ^6.0.3 | AI é›†æˆ |
| **@ai-sdk/google** | ^3.0.1 | Google Gemini æ¨¡å‹ |
| **Zod** | ^4.2.1 | Schema éªŒè¯ / Structured Output |

### å·¥å…·
| æŠ€æœ¯ | ç”¨é€” |
|------|------|
| **next-pwa** | PWA æ”¯æŒ |
| **diff** | æ–‡æœ¬å·®å¼‚è®¡ç®— |

---

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        å®¢æˆ·ç«¯ (Browser/PWA)                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   Pages     â”‚  â”‚ Components  â”‚  â”‚     Zustand Store       â”‚  â”‚
â”‚  â”‚  - /        â”‚  â”‚ - Editor    â”‚  â”‚  - blocks (TextBlock[]) â”‚  â”‚
â”‚  â”‚  - /login   â”‚  â”‚ - Voice     â”‚  â”‚  - reviewState          â”‚  â”‚
â”‚  â”‚  - /notebookâ”‚  â”‚ - Review    â”‚  â”‚  - chatHistory          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â”‚                â”‚                      â”‚                 â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                               â”‚                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                       â”‚
                    â–¼                       â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚  Server Actions â”‚    â”‚   REST API v1   â”‚
          â”‚  (è–„å£³å±‚)        â”‚    â”‚   (è–„å£³å±‚)       â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚                      â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   AuthService   â”‚ â† è®¤è¯é€»è¾‘
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                             â”‚
              â–¼                             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   NoteService   â”‚           â”‚    AIService    â”‚
    â”‚ (æ•°æ®åº“æ“ä½œ)     â”‚           â”‚  (AI ä¸šåŠ¡é€»è¾‘)   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚                             â”‚
             â–¼                             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚     Prisma      â”‚           â”‚   Google AI     â”‚
    â”‚   (PostgreSQL)  â”‚           â”‚   (Gemini)      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### API ä¼˜å…ˆæ¶æ„

ä¸ºäº†æœªæ¥è¿ç§»åˆ° React Nativeï¼Œé‡‡ç”¨ **API ä¼˜å…ˆæ¶æ„**ï¼š

- **Server Actions**ï¼šNext.js Web å®¢æˆ·ç«¯ä½¿ç”¨
- **REST API v1**ï¼šæœªæ¥ React Native App ä½¿ç”¨
- **Service å±‚**ï¼šå…±äº«ä¸šåŠ¡é€»è¾‘ï¼Œé¿å…é‡å¤å®ç°

```
src/
â”œâ”€â”€ services/           # ä¸šåŠ¡é€»è¾‘å±‚ (æ ¸å¿ƒ)
â”‚   â”œâ”€â”€ authService.ts    # è®¤è¯æœåŠ¡
â”‚   â”œâ”€â”€ aiService.ts      # AI å¤„ç†æœåŠ¡
â”‚   â””â”€â”€ noteService.ts    # ç¬”è®°æ•°æ®æœåŠ¡
â”‚
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ actions/        # Server Actions (è–„å£³)
â”‚   â”‚   â”œâ”€â”€ noteActions.ts
â”‚   â”‚   â””â”€â”€ aiActions.ts
â”‚   â”‚
â”‚   â””â”€â”€ api/v1/         # REST API (è–„å£³)
â”‚       â”œâ”€â”€ notebooks/
â”‚       â””â”€â”€ ai/
```

---

## ğŸ“Š æ•°æ®ç»“æ„

### æ•°æ®åº“æ¨¡å‹ (Prisma Schema)

```prisma
// ============================================
// ç”¨æˆ·é…ç½® - å…³è” Supabase Auth
// ============================================
model UserProfile {
  id        String     @id @default(uuid())
  authId    String     @unique          // Supabase Auth user ID
  email     String?
  name      String?
  avatarUrl String?
  createdAt DateTime   @default(now())
  updatedAt DateTime   @updatedAt
  notebooks Notebook[]                  // ä¸€å¯¹å¤šï¼šç”¨æˆ·çš„ç¬”è®°æœ¬
}

// ============================================
// ç¬”è®°æœ¬ - ç¬”è®°çš„å®¹å™¨
// ============================================
model Notebook {
  id          String   @id @default(uuid())
  userId      String                    // å¤–é”® -> UserProfile
  title       String   @default("Untitled Notebook")
  description String?
  emoji       String?  @default("ğŸ“")   // å›¾æ ‡
  isArchived  Boolean  @default(false)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  user        UserProfile @relation(...)
  notes       Note[]                    // ä¸€å¯¹å¤šï¼šç¬”è®°æœ¬çš„ç¬”è®°
}

// ============================================
// ç¬”è®° - å†…å®¹çš„åŸå­å•ä½
// ============================================
model Note {
  id         String   @id @default(uuid())
  notebookId String                     // å¤–é”® -> Notebook
  content    String   @default("")      // Markdown å†…å®¹
  type       NoteType @default(PARAGRAPH)
  order      Int      @default(0)       // æ’åºä½ç½®
  isEmpty    Boolean  @default(true)
  metadata   Json?                      // æ‰©å±•å­—æ®µ
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
  notebook   Notebook @relation(...)
}

// ============================================
// ç¬”è®°ç±»å‹æšä¸¾
// ============================================
enum NoteType {
  HEADING_1
  HEADING_2
  HEADING_3
  PARAGRAPH
  BULLET_LIST
  NUMBERED_LIST
  QUOTE
  CODE_BLOCK
  DIVIDER
}
```

### å®¢æˆ·ç«¯ç±»å‹

```typescript
// ============================================
// TextBlock - ç¼–è¾‘å™¨ä¸­çš„å†…å®¹å—
// ============================================
interface TextBlock {
  id: string;        // UUID
  content: string;   // Markdown å†…å®¹
  isEmpty: boolean;  // æ˜¯å¦ä¸ºç©º
}

// ============================================
// AI å“åº”ç»“æ„
// ============================================
interface AIResponse {
  type: 'append' | 'review' | 'review_immediate' | 'inquire';
  content: string;      // AI ç”Ÿæˆçš„å†…å®¹
  userInput: string;    // ç”¨æˆ·è¯´äº†ä»€ä¹ˆ
  thought?: string;     // AI æ€è€ƒè¿‡ç¨‹ (è°ƒè¯•ç”¨)
  changedCharCount?: number;  // å˜æ›´å­—ç¬¦æ•°
}

// ============================================
// Review çŠ¶æ€ - AI ä¿®æ”¹å»ºè®®
// ============================================
interface ReviewState {
  blockId: string | null;      // è¢«ä¿®æ”¹çš„ blockï¼Œnull è¡¨ç¤ºå…¨æ–‡
  response: AIResponse;        // AI å“åº”
  originalContent: string;     // åŸå§‹å†…å®¹
}

// ============================================
// å¯¹è¯æ¶ˆæ¯ - è¿½é—®æ¨¡å¼
// ============================================
interface ChatMessage {
  id: string;
  role: 'user' | 'ai';
  content: string;
  timestamp: number;
}
```

---

## ğŸ”„ æ ¸å¿ƒä¸šåŠ¡é€»è¾‘

### 1. AI å¤„ç†æµç¨‹

```
ç”¨æˆ·è¯­éŸ³/æ–‡æœ¬è¾“å…¥
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åˆ¤æ–­ç¼–è¾‘æ¨¡å¼      â”‚
â”‚  - è¡Œå†…ç¼–è¾‘æ¨¡å¼    â”‚
â”‚  - å…¨å±€æ¨¡å¼       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è°ƒç”¨ Gemini API  â”‚
â”‚  (generateObject) â”‚
â”‚  - ç»“æ„åŒ–è¾“å‡º      â”‚
â”‚  - Few-shot ç¤ºä¾‹  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è§£æ AI å“åº”      â”‚
â”‚  type: append     â”‚  â†’ ç›´æ¥è¿½åŠ å†…å®¹
â”‚  type: review     â”‚  â†’ è®¡ç®— Diff
â”‚  type: inquire    â”‚  â†’ æ˜¾ç¤ºè¿½é—®å¼¹çª—
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ›´æ–° Zustand     â”‚
â”‚  - blocks         â”‚
â”‚  - reviewState    â”‚
â”‚  - chatHistory    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. AI å“åº”ç±»å‹å¤„ç†

| ç±»å‹ | è§¦å‘æ¡ä»¶ | å¤„ç†æ–¹å¼ |
|------|----------|----------|
| `append` | ç”¨æˆ·å£è¿°å†…å®¹ | ç›´æ¥è¿½åŠ åˆ°å½“å‰ block |
| `review` | ç”¨æˆ·è¯´"æ”¹"ã€"åˆ "ã€"æ¢" | è®¡ç®— Diffï¼Œ>10å­—æ˜¾ç¤º Diff è§†å›¾ |
| `review_immediate` | å°ä¿®æ”¹ (â‰¤10å­—) | ç›´æ¥åº”ç”¨ï¼Œè·³è¿‡ Diff è§†å›¾ |
| `inquire` | ä¿¡æ¯ä¸è¶³ | æ˜¾ç¤ºè¿½é—®å¼¹çª—ï¼Œå¤šè½®å¯¹è¯ |

### 3. è‡ªåŠ¨ä¿å­˜æœºåˆ¶

```typescript
// è§¦å‘æ¡ä»¶ï¼šblocks å˜åŒ–å 2 ç§’
// å®ç°ï¼šé˜²æŠ– (debounce) + æ‰¹é‡åŒæ­¥

blocks å˜åŒ– â†’ ç­‰å¾… 2s â†’ syncNotes() â†’ æ•°æ®åº“
                â†‘
            æ¸…é™¤ä¸Šæ¬¡è®¡æ—¶å™¨
```

### 4. Undo/Redo å†å²

```typescript
// æœ€å¤šä¿å­˜ 5 æ­¥å†å²
interface HistoryState {
  history: TextBlock[][];  // å†å²å¿«ç…§æ ˆ
  future: TextBlock[][];   // é‡åšæ ˆ
}

// è§¦å‘ä¿å­˜å¿«ç…§çš„æ“ä½œï¼š
// - åˆ é™¤ block
// - åˆå¹¶ block
// - AI ä¿®æ”¹å†…å®¹
```

---

## ğŸ—‚ï¸ ç›®å½•ç»“æ„

```
ai-notes-app/
â”œâ”€â”€ prisma/
â”‚   â””â”€â”€ schema.prisma           # æ•°æ®åº“æ¨¡å‹å®šä¹‰
â”‚
â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ manifest.json           # PWA é…ç½®
â”‚   â””â”€â”€ icons/                  # åº”ç”¨å›¾æ ‡
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/                    # Next.js App Router
â”‚   â”‚   â”œâ”€â”€ page.tsx              # é¦–é¡µ (Dashboard)
â”‚   â”‚   â”œâ”€â”€ login/page.tsx        # ç™»å½•é¡µ
â”‚   â”‚   â”œâ”€â”€ notebook/[id]/page.tsx # ç¬”è®°ç¼–è¾‘å™¨
â”‚   â”‚   â”œâ”€â”€ actions/              # Server Actions
â”‚   â”‚   â”‚   â”œâ”€â”€ noteActions.ts      # ç¬”è®°æ“ä½œ
â”‚   â”‚   â”‚   â””â”€â”€ aiActions.ts        # AI æ“ä½œ
â”‚   â”‚   â””â”€â”€ api/v1/               # REST API
â”‚   â”‚       â”œâ”€â”€ notebooks/          # ç¬”è®°æœ¬ CRUD
â”‚   â”‚       â””â”€â”€ ai/                 # AI ç«¯ç‚¹
â”‚   â”‚
â”‚   â”œâ”€â”€ components/             # React ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ EditorBlock.tsx       # ç¼–è¾‘å™¨æ ¸å¿ƒ
â”‚   â”‚   â”œâ”€â”€ NoteBlock.tsx         # ç¬”è®°å—æ¸²æŸ“
â”‚   â”‚   â”œâ”€â”€ VoiceGesture.tsx      # è¯­éŸ³æ‰‹åŠ¿
â”‚   â”‚   â”œâ”€â”€ VoiceHUD/             # è¯­éŸ³ HUD
â”‚   â”‚   â”œâ”€â”€ ReviewBlock.tsx       # Diff è§†å›¾
â”‚   â”‚   â”œâ”€â”€ ReviewCard.tsx        # Review å¡ç‰‡
â”‚   â”‚   â”œâ”€â”€ ClarificationModal.tsx # è¿½é—®å¼¹çª—
â”‚   â”‚   â”œâ”€â”€ NavigationBar.tsx     # å¯¼èˆªæ 
â”‚   â”‚   â””â”€â”€ NotebookCard.tsx      # ç¬”è®°æœ¬å¡ç‰‡
â”‚   â”‚
â”‚   â”œâ”€â”€ hooks/                  # è‡ªå®šä¹‰ Hooks
â”‚   â”‚   â”œâ”€â”€ useRecorder.ts        # å½•éŸ³é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ useAutoSave.ts        # è‡ªåŠ¨ä¿å­˜
â”‚   â”‚   â””â”€â”€ useAuth.ts            # è®¤è¯çŠ¶æ€
â”‚   â”‚
â”‚   â”œâ”€â”€ services/               # ä¸šåŠ¡é€»è¾‘å±‚ â­
â”‚   â”‚   â”œâ”€â”€ authService.ts        # è®¤è¯æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ aiService.ts          # AI æœåŠ¡
â”‚   â”‚   â””â”€â”€ noteService.ts        # ç¬”è®°æœåŠ¡
â”‚   â”‚
â”‚   â”œâ”€â”€ store/                  # çŠ¶æ€ç®¡ç†
â”‚   â”‚   â””â”€â”€ noteStore.ts          # Zustand Store
â”‚   â”‚
â”‚   â”œâ”€â”€ lib/                    # å·¥å…·åº“
â”‚   â”‚   â”œâ”€â”€ prisma.ts             # Prisma å®¢æˆ·ç«¯
â”‚   â”‚   â””â”€â”€ supabase/             # Supabase å®¢æˆ·ç«¯
â”‚   â”‚
â”‚   â””â”€â”€ types/                  # ç±»å‹å®šä¹‰
â”‚       â”œâ”€â”€ note.ts               # ç¬”è®°ç›¸å…³ç±»å‹
â”‚       â””â”€â”€ ai.ts                 # AI ç›¸å…³ç±»å‹
â”‚
â”œâ”€â”€ docs/                       # æ–‡æ¡£
â”‚   â”œâ”€â”€ system_architecture.md  # æœ¬æ–‡æ¡£
â”‚   â””â”€â”€ ENV_SETUP.md            # ç¯å¢ƒå˜é‡é…ç½®
â”‚
â””â”€â”€ vercel.json                 # Vercel éƒ¨ç½²é…ç½®
```

---

## ğŸ”Œ API ç«¯ç‚¹

### REST API v1

| æ–¹æ³• | ç«¯ç‚¹ | æè¿° |
|------|------|------|
| GET | `/api/v1/notebooks` | è·å–ç”¨æˆ·æ‰€æœ‰ç¬”è®°æœ¬ |
| POST | `/api/v1/notebooks` | åˆ›å»ºæ–°ç¬”è®°æœ¬ |
| GET | `/api/v1/notebooks/[id]` | è·å–ç¬”è®°æœ¬è¯¦æƒ… |
| PATCH | `/api/v1/notebooks/[id]` | æ›´æ–°ç¬”è®°æœ¬ |
| DELETE | `/api/v1/notebooks/[id]` | åˆ é™¤ç¬”è®°æœ¬ |
| GET | `/api/v1/notebooks/[id]/notes` | è·å–ç¬”è®°åˆ—è¡¨ |
| POST | `/api/v1/notebooks/[id]/notes` | åˆ›å»ºç¬”è®° |
| PUT | `/api/v1/notebooks/[id]/notes` | æ‰¹é‡åŒæ­¥ç¬”è®° |
| POST | `/api/v1/ai/voice` | å¤„ç†è¯­éŸ³è¾“å…¥ |
| POST | `/api/v1/ai/text` | å¤„ç†æ–‡æœ¬è¾“å…¥ |

### è®¤è¯æ–¹å¼

```typescript
// æ–¹å¼ 1: Cookie (Web å®¢æˆ·ç«¯)
// è‡ªåŠ¨é€šè¿‡ Supabase SSR å¤„ç†

// æ–¹å¼ 2: Bearer Token (æœªæ¥ RN App)
Authorization: Bearer <supabase_access_token>
```

---

## ğŸ” è®¤è¯æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·ç‚¹å‡»    â”‚    â”‚  Supabase   â”‚    â”‚  å›è°ƒå¤„ç†   â”‚
â”‚  Google ç™»å½• â”‚ -> â”‚  OAuth æµç¨‹  â”‚ -> â”‚  /auth/callback â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                                             â”‚
                                             â–¼
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚ åˆ›å»º/æ›´æ–°    â”‚
                                    â”‚ UserProfile â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                                           â”‚
                                           â–¼
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚  é‡å®šå‘åˆ°   â”‚
                                    â”‚  Dashboard  â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸš€ éƒ¨ç½²é…ç½®

### Vercel é…ç½® (vercel.json)

```json
{
  "regions": ["sin1"],  // æ–°åŠ å¡åŒºåŸŸ (é è¿‘ Supabase)
  "functions": {
    "src/app/**/*.ts": {
      "maxDuration": 30
    }
  }
}
```

### ç¯å¢ƒå˜é‡

```bash
# Supabase
NEXT_PUBLIC_SUPABASE_URL=https://xxx.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJ...

# æ•°æ®åº“
DATABASE_URL=postgresql://...?pgbouncer=true
DIRECT_URL=postgresql://...

# AI
GOOGLE_API_KEY=AIza...
GOOGLE_BASE_URL=https://generativelanguage.googleapis.com/v1beta
GEMINI_MODEL=gemini-2.0-flash-exp
```

---

## ğŸ“± PWA é…ç½®

åº”ç”¨å·²é…ç½®ä¸º PWAï¼Œæ”¯æŒï¼š
- æ·»åŠ åˆ°ä¸»å±å¹•
- å…¨å±è¿è¡Œ (æ— æµè§ˆå™¨ UI)
- ç¦»çº¿åŸºç¡€æ”¯æŒ

```json
// manifest.json
{
  "name": "AI Notes",
  "short_name": "AI Notes",
  "display": "standalone",
  "orientation": "portrait"
}
```

---

## ğŸ”® æœªæ¥è¿ç§»æŒ‡å—

### è¿ç§»åˆ° React Native

1. **å¤ç”¨ Service å±‚**ï¼š
   - `authService.ts` - æ›¿æ¢ Supabase SSR ä¸º RN ç‰ˆæœ¬
   - `aiService.ts` - ç›´æ¥å¤ç”¨
   - `noteService.ts` - ç›´æ¥å¤ç”¨

2. **ä½¿ç”¨ REST API**ï¼š
   - RN App è°ƒç”¨ `/api/v1/*` ç«¯ç‚¹
   - ä½¿ç”¨ Bearer Token è®¤è¯

3. **æ›¿æ¢ UI ç»„ä»¶**ï¼š
   - React ç»„ä»¶ â†’ React Native ç»„ä»¶
   - Tailwind CSS â†’ StyleSheet / NativeWind

4. **çŠ¶æ€ç®¡ç†**ï¼š
   - Zustand å¯ç›´æ¥åœ¨ RN ä¸­ä½¿ç”¨

---

## ğŸ“ å˜æ›´æ—¥å¿—

| æ—¥æœŸ | ç‰ˆæœ¬ | å˜æ›´ |
|------|------|------|
| 2025-01-07 | 0.1.0 | åˆå§‹æ¶æ„æ–‡æ¡£ |
| 2025-01-07 | 0.1.0 | é‡æ„ä¸º API ä¼˜å…ˆæ¶æ„ |
